# Implementation of [publication](https://ieeexplore.ieee.org/document/6946667) for detecting changes on satellite images

Made for solving [Kaggle problem](https://www.kaggle.com/c/roscosmos-rucode/overview)

Суть эксперимента - показать как работает алгоритм классической обработки изображений [SIFT](https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D1%81%D1%88%D1%82%D0%B0%D0%B1%D0%BD%D0%BE-%D0%B8%D0%BD%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%D0%BD%D0%B0%D1%8F_%D1%82%D1%80%D0%B0%D0%BD%D1%81%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F_%D0%BF%D1%80%D0%B8%D0%B7%D0%BD%D0%B0%D0%BA%D0%BE%D0%B2), но в адаптированном к спутниковым изображениям случае. В частности, имплиментирована публикация F. Dellinger, J. Delon, Y. Gousseau, J. Michel and F. Tupin, "Change detection for high resolution satellite images, based on SIFT descriptors and an a contrario approach," 2014 IEEE Geoscience and Remote Sensing Symposium, 2014, pp. 1281-1284, doi: 10.1109/IGARSS.2014.6946667 [можно посмотреть текст статьи](https://hal.archives-ouvertes.fr/hal-01059366/document).

Постановка задачи: Найти изменения на двух спутниковых изображениях одного и того-же участка Земли. Основные сложности - солнечные блики, облака, атмосферные явления, тени. 

Базовое решение: Берётся разность изображений и порог интенсивности (я брала нижний и верхний порог, так как есть тени и блики дающие наибольшие значения разности, а также есть облака и атмосферные явления дающие небольшое на вид значение разности). Данное решение также мной реализовано и можно посмотреть на его результаты.

Алгоритм решения с помощью SIFT:

1. Берётся два изображения одной и той же местности, сделанные в разные моменты времени. Находятся ключевые точки (key points) на каждом изображении и их дескрипторы, с помощью алгоритма масштабно-инвариантной трансформации признаков.
2. Далее берётся алгоритм KNN с k=2 ближайшими соседями, с помощью которого находятся совпадения ключевых точек на двух изображениях.
3. Используется (Lowe's ratio test)[https://stackoverflow.com/questions/51197091/how-does-the-lowes-ratio-test-work] для отбора достаточно достоверных совпадений.
4. Далее реализуем подход от противного, основанный на принципе Гельмгольца: человеческие глаза замечают структуру только в том случае, если она не появляется случайным образом. Этот подход основан на двух основных концепциях: фоновой модели, описывающей конфигурации, в которых не должны быть обнаружены структуры (H0 hypothesis), и измерении обнаруживаемых структур. Затем каждому измерению присваивается мера сигнификативности, называемая N F A (Количество ложных тревог), количественно оценивающая маловероятность данной структуры в фоновой модели H0. Затем F определяется из вероятности $P(X≥x)$,X -случайная величина из биномиального распределения, соответствующая распределению измерения в фоновой модели. Пороговое значение $N F A ≤ ε$, при этом ε мало, позволяет нам обнаруживать структуры. На деле вокруг каждойключевой точки берётся окрестность с заданным радиусом, находится количество совпадений в этой окрестности и количество ключевых точек. И если описывать совсем простым языком, мы смотрим на втором изображении больше совпадений вокруг заданной точки, или же новых ключевых точек по сравнению с первым  изображением, и считаем количество ложных тревог для каждой ключевой точки.
5. Если количество ложных тревог N F A меньше заданного нами трешхолда, в итоговую маску изменений (1 - изменение есть, 0 - нет) заносятся 1 по всему радиусу вокруг проверенной ключевой точки.
